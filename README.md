# Enroll me - web server

### API
Мы используем REST API https://ru.wikipedia.org/wiki/REST  
Параметры https://ru.wikipedia.org/wiki/URL#параметры    

#### /api/clients/add - добавить нового клиента 
Параметры: 
1. app_id - id установленной на телефон программы (GUID 36 символов)
1. name - contact name
1. phone - phone number
1. social - заметкак как можно связаться с клиентом, напрмер whatsup или vk 
1. location - адрес клиента  
Возвращает ошибку или нового клиента как json 
Пример:      
Request:  
http://192.168.1.41:8888/api/clients/add?app_id=1&name=Maria&phone=12345&social=whatsup&location=Gatchina  
Response:  
{"id":6,"app_id":"1","name":"Maria","phone":"12345","socilaMedia":"whatsup","location":"Gatchina"}  


#### /api/clients/get_all_clients - получить весь список клиентов 
Параметры:  
1. app_id - id установленной на телефон программы 
Возвращает ошибку или спискок всех клиентов как json 
Пример:      
Request:  
http://192.168.1.41:8888/api/clients/get_clients?app_id=1  
Response:  
{"id":6,"app_id":"1","name":"Maria","phone":"12345","socilaMedia":"whatsup","location":"Gatchina"}  


#### /api/clients/get_invite - сформировать приглашение на запись
1. user_id - id клиента из базы данных  
Сервер по этой команде прочитает из базы данных данные клиента и создаст запись в таблице визитов.
В записи будут данные клиента и время создания приглашения. 
Клиенту останется только проставить дату и коментарий.  
Команда вернет guid записи.  


#### /enroll - записать себя на визит к мастеру
Параметры
1. invite - (guid) уникальная строка приглашения на запись, ее генерирует клиентское пришашение запросом /get_invite  
http://localhost:8888/enroll?invite=6F9619FF-8B86-D011-B42D-00CF4FC964FF


### Use cases
#### Самозапись клиента на прием
1. Мастер выбирает клиента и создает через сервер приглашение на запись
1. Мастер высылает приглашение на запись и посылает ссылку на приглашение клиенту через смс.
1. Клиент переходит по ссылке из смс и проставляет время визита к мастеру
#### Просмотр клиентом записи на прием
1. Клиент переходит по ссылке из смс по которой он ранее создавал запись
1. Клиент видит свою запись
#### Ссылки с истекщим временем
1. Клиент переходит по ссылке из смс 
1. Клиент видит надпись - ваша ссылка устарела, приглашение на запись действительно только 2 дня

